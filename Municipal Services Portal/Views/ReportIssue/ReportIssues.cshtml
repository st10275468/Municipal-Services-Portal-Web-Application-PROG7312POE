@{
    ViewData["Title"] = "Report Issues";
  
}
<div class="report-section">
    <div class="container">
        <div class="reportHero-text">
            <h1>Report an Issue</h1>
            <p>Fill out the form below to submit a report</p>
        </div>

        <div class="cards-wrapper">
            <div class="report-card">
                <h5>Submit Your Issue</h5>
                <div id="successMessage" class="alert alert-success text-center"
                     style="display:none; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); width:80%; z-index:10; opacity:1;">
                </div>
                <!--Form where users can submit and report issues-->
                <form id="reportForm" asp-action="ReportIssues" method="post" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Location</label>
                        <input type="text" id="location" name="location" class="form-control" placeholder="Enter Location" required />
                        <small class="text-muted"> Example: 123 Main Street</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Category</label>
                        <select id="category" name="category" class="form-select" required>
                            <option value="">Select a category</option>
                            <option value="Roads">Roads</option>
                            <option value="Traffic">Traffic</option>
                            <option value="Drainage">Drainage</option>
                            <option value="Sanitation">Sanitation</option>
                            <option value="Water">Water</option>
                            <option value="Electricity">Electricity</option>
                            <option value="Lighting">Lighting</option>
                            <option value="Waste">Waste</option>
                            <option value="Parks">Parks</option>
                            <option value="Environment">Environment</option>
                            <option value="Buildings">Buildings</option>
                            <option value="Health">Health</option>
                            <option value="Safety">Safety</option>
                            <option value="Other">Other</option>
                        </select>
                        <small class="text-muted"> Select the type of issue</small>
                    </div>
                   
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Description</label>
                        <textarea id="description" name="description" class="form-control" rows="4" placeholder="Describe the issue" required></textarea>
                        <small class="text-muted"> Describe the issue in detail</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Attach Photo/Document</label>
                        <input type="file" name="media" class="form-control" />
                    </div>

                    <div class="mb-4">
                        <div class="progress" style="height: 30px; border-radius: 8px;">
                            <div id="progressBar" class="progress-bar" role="progressbar" style="width:0%; background-color: var(--primary-color); font-size: 0.8rem;">
                                0%
                            </div>
                        </div>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="btn-cta">Submit Issue</button>
                    </div>

                    
                </form>
            </div>
            <!--General tips for submitting issues-->
            <div class="tips-card">
                <h5>Tips for Submitting Issues</h5>
                <ul class="list-unstyled mb-0">
                    <li>> Be specific about the location</li>
                    <li>> Describe the issue in detail</li>
                    <li>> Select the correct category</li>
                    <li>> Attach supporting photos</li>
                    <li>> Use clear language</li>
                    <li>> Check the progress bar</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!--Creating a functional progress bar and success message-->
@section Scripts {
    <script>
        const inputs = ['location', 'category', 'description'];
        const progressBar = document.getElementById('progressBar');

        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', updateProgress);
        });

        function updateProgress() {
            let filled = inputs.filter(id => document.getElementById(id).value.trim() !== "").length;
            let percent = (filled / inputs.length) * 100;
            progressBar.style.width = percent + '%';
            progressBar.innerText = Math.round(percent) + '% complete';
        }
            window.addEventListener('load', () => {
            const successMessage = document.getElementById('successMessage');
            @if (ViewBag.Message != null)
            {
                    <text>
                    successMessage.innerText = "@ViewBag.Message";
                    successMessage.style.display = 'block';

                    setTimeout(() => {
                        successMessage.style.transition = "opacity 0.5s";
                        successMessage.style.opacity = 0;
                        setTimeout(() => successMessage.style.display = 'none', 500);
                    }, 3000);
                    </text>
            }
        });

    </script>
}
